pico-8 cartridge // http://www.pico-8.com
version 38
__lua__
function _init()
	p={x=20,y=60,speed=4,life=3}
	bullets={}	
 	position = p.x
	create_stars()
	create_asteroids(3)
	game_over=0
end

function _update()
	if(game_over==0) update_game()
	if(game_over==1) update_game_over()
end
	
function _draw()
	if(game_over==0) draw_game()
	if(game_over==1) draw_game_over()
end

function update_game()
	-- update position player --
	position = p.x
	update_asteroids()	
	-- move player --
	if (btn(➡️)) p.x+=1
	if (btn(⬅️)) p.x-=1 
	if (btn(⬆️)) p.y-=1 
	if (btn(⬇️)) p.y+=1
	-- bullet function --
	if (btnp(❎)) shoot()
	update_bullets()
	update_stars()
	
end

function draw_game()
	cls()
		-- afficher etoiles --
	for s in all(stars) do
		pset(s.x,s.y,s.col)
	end
	map()
		-- afficher asteroides --
	for a in all(asteroids) do
		spr(a.style,a.x,a.y)
	end
		-- bullets --
	for i in all(bullets) do
		spr(3,i.x,i.y)
	end
	-- afficher player --
	spr(1,p.x,p.y)
	-- affichage reacteurs --
	if p.x > position 
		then spr(5,p.x-8,p.y)	
	end
end
-->8
--bullets

function shoot()
	new_bullet={
		x=p.x,
		y=p.y,
		speed=4,
	}
	add(bullets,new_bullet)
	sfx(0)
end

function update_bullets()
	for i in all(bullets) do
		i.x+=i.speed
		if i.x > 129 then
			del(bullets,i)
		end
	end
end

-->8
--background

function create_stars()
	stars={}
	for i=1,20 do
	new_star = {
		x = rnd(128),
		y = rnd(128),
		col = rnd({15,6,13}),
		speed = 1+rnd(1)
	}
	add(stars,new_star)
	end
	for i=1,8 do
	new_star = {
		x = rnd(128),
		y = rnd(128),
		col = 1,
		speed = 0.5+rnd(0.5)
	}
	add(stars,new_star)
	end
	end
	
	function update_stars()
	for s in all(stars) do
		s.x-=s.speed
		if s.x<0 then
			s.x=128
			s.y=rnd(128)
		end
	end
	end
-->8
--asteroid
	
	function create_asteroids(nombre)
	asteroids={}
	for i=1,nombre do
	new_asteroid = {
		x = rnd({136,144, 162}),
		y = rnd(120),
		style = rnd({6,7,8}),
		speed = 0.5
	}
	add(asteroids,new_asteroid)
	end
	end
	
	function update_asteroids()
	for a in all(asteroids) do
		a.x-=a.speed
		if a.x<-8 then 
			del(asteroids,a)
			create_asteroids(3)
		end
	end
	for a in all(asteroids) do
		if collision(p,a) then
			p.life-=0.0625
			if p.life==0 then
				game_over=1
			end
		end
	end
	end

-->8
--collision asteroid joueur

function collision(a,b)
	if a.y+8 < b.y
	or a.y   > b.y + 8
	or a.x+8 < b.x
	or a.x   > b.x + 8 then 
		return false
	else 
		return true
	end
end
-->8
--gameover

function update_game_over()

end

function draw_game_over()
	cls()
	print("game over",45,60,7)
end
__gfx__
0000000006bb000009999990000000000000000080899a7000066600000000000000000000000000000000000000000000000000000000000000000000000000
000000000033333000aaaa9002c3a98000600000000000000066656000066000000566000000feee222999eeeee0000008000000000000000000000000000000
007007006b3bbb000aacacaa00000000000070008089a700065666600656660006666660000fee88882299999e88800000000000000000000000000000000000
000770000b3b7cbb00aaaaa000000000000000600000000065666666066666006655656600fee88888822999eeee880000000000000000000000000000000000
000770000b3bccbb00a00aa00000000006000600000000006666666006665600066566560fee88888828229eeee8800000000000000000000000000000000000
007007006b3bbb000117871100000000000000008089a700066655600066000000666660fee88888828222299e88888000000000000000000000000000000000
00000000003333300a17871a02c3a9800070000000000000006656000000000000066000feee88888828222999e8888880080000000000000000000000000000
0000000006bb000009178719000000000000000080899a70000660000000000000000000fee8e88888822229999ee88000000000000000000000000000000000
000000000000000001007001000000000000000000000000000000000000000000000000feee88882822222999eeeee800000000000000000000000000000000
000000000000000001077701000000000000000000000000000000000000000000000000fee8e888828222299eeee88880000800000000000000000000000000
000000000000000008007008000000000000000000000000000000000000000000000000fee8888888282229eeee880000000000000000000000000000000000
0000000000000000070070070000000000000000000000000000000000000000000000000fee88888882229eee88888800000000000000000000000000000000
00000000000000000800000800000000000000000000000000000000000000000000000000fee88882822999e888800000000000000000000000000000000000
000000000000000007007007000000000000000000000000000000000000000000000000000fee8888229eeeee80008000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000feee222999000000000000000000000000000000000000000000
00000000000000000a00700a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000666666660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000006dddddd10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000006d1111d10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000006d1dd6d10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000006d1dd6d10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000006d1666d10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000006dddddd10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000010000000101010000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000002100000000002100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000002100000000002100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000002100000000002100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000002100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000002100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000210000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000210000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000210000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000002100000000210000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000002100000000210000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000002100000000210000002100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000002100000000210000002100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000002100000000210000002100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000002100000000210000002100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
0001000039050380503705036050350503305032050300402c0402802025010210101b050120500e0500905006050040500000000000000000000000000000000000000000000000000000000000000000000000
