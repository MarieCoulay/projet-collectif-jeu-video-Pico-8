pico-8 cartridge // http://www.pico-8.com
version 38
__lua__
-- mahin mehdi marie project --

function _init()
	create_player()
	e={x=130,y=60,life=4}
	postillons={}
	bullets={}	
	position = p.x
	create_stars()
	create_asteroids(3)
	game_over=0
end

function _update60()
 if(game_over==0) update_game()
	if(game_over==1) update_game_over()
end

function _draw()
	if(game_over==0) draw_game()
	if(game_over==1) draw_game_over()
end
-->8
--bullets

function shoot()
	new_bullet={
		x=p.x,
		y=p.y,
		speed=4,
	}
	add(bullets,new_bullet)
	sfx(0)
end


function update_bullets()
	for i in all(bullets) do
		i.x+=i.speed
		if i.x > 129 then
			del(bullets,i)
		end
	end
end

-->8
--background

function create_stars()
	stars={}
	for i=1,20 do
		new_star = {
			x = rnd(128),
			y = rnd(128),
			col = rnd({15,6,13}),
			speed = 1+rnd(1)
		}
		add(stars,new_star)
	end
		for i=1,8 do
			new_star = {
				x = rnd(128),
				y = rnd(128),
				col = 1,
				speed = 0.5+rnd(0.5)
			}
			add(stars,new_star)
		end
	end
	
function update_stars()
		for s in all(stars) do
			s.x-=s.speed
			if s.x<0 then
				s.x=128
				s.y=rnd(128)
			end
		end
	end
-->8
--asteroid
	
function create_asteroids(nombre)
	asteroids={}
		for i=1,nombre do
			new_asteroid = {
				x = rnd({136,144, 162}),
				y = rnd(120),
				style = rnd({6,7,8}),
				speed = 0.5
			}
			add(asteroids,new_asteroid)
		end
	end
	

	function update_asteroids()
	for a in all(asteroids) do
		a.x-=a.speed
		if a.x<-8 then 
			del(asteroids,a)
			create_asteroids(3)
		end
	end
	for a in all(asteroids) do
		if collision(p,a) then
			p.life-=0.0625
			if p.life==0 then
				game_over=1
			end
		end
	end
	end
-->8
-- map --

function draw_map()
	map(0,0,0,0,128,64)
end


-->8
-- player 
function create_player()
	p={x=20,y=60,sprite=1,life=3}
end

function draw_player()
	spr(p.sprite,p.x,p.y)
end

function player_movement()

	if (btn(➡️)) p.x+=1
	if (btn(⬅️)) p.x-=1 
	if (btn(⬆️)) p.y-=1 
	if (btn(⬇️)) p.y+=1
	
end
-->8
-- update game

function update_game()
	-- update position player --
	position = p.x
	player_movement()
	-- bullet function --
	if (btnp(❎)) shoot()
	update_bullets()
	-- stars --
	update_stars()	
	-- asteroides --
	update_asteroids()	
	-- ennemy --
	update_enemies()	
	--shoot_enemy function
	if e.x==110 and #postillons<2
	then
	shoot_enemy()
	end
	update_postillons()
end

-- update game over

function update_game_over()

end

function draw_game_over()
	cls()
	print("game over",45,60,7)
end
-->8
-- draw game

function draw_game()
	cls()
	draw_map()
		-- affichage player --
	draw_player()

		-- affichage etoiles --
	for s in all(stars) do
		pset(s.x,s.y,s.col)
	end
	
		-- affichage asteroides --
	for a in all(asteroids) do
		spr(a.style,a.x,a.y)
	end
	
		-- affichage bullets --
	for i in all(bullets) do
		spr(3,i.x,i.y)
	end
	
		-- affichage reacteurs --
	if p.x > position 
		then spr(5,p.x-8,p.y)	
	end

		-- afichage ennemi --
	spr(2,e.x,e.y)

		-- affichage postillons --
	for pt in all(postillons) do
	spr(4,pt.x-8,pt.y)
	end
end
-->8
-- collision

function collision(a,b)
	if a.y+8 < b.y
	or a.y   > b.y + 8
	or a.x+8 < b.x
	or a.x   > b.x + 8 then 
		return false
	else 
		return true
	end
end

-->8
--enemies

function update_enemies()
	if e.x>110 then 
		e.x-=1
	end
end

-->8
--bullets enemy

function shoot_enemy()
	new_postillon={
	x=e.x,
	y=e.y,
	speed=2
	}
	add(postillons,new_postillon)
	sfx(0)
end

function update_postillons()
	for pt in all(postillons) do
	pt.x-=pt.speed
		if pt.x<-100 then 
  pt.x=e.x
  pt.y=e.y
		end
	end
	
	
end
__gfx__
0000000006bb000009999990000000000000000008089a7000066600000000000000000000000000000000000000000000000000000000000000000000000000
000000000033333000aaaa9002c3a98000600000000000000066656000066000000566000000feee222999eeeee0000008000000000000000000000000000000
007007006b3bbb000aacacaa00000000000070008089a700065666600656660006666660000fee88882299999e88800000000000000000000000000000000000
000770000b337cbb00aaaaa000000000000000600000000065666666066666006655656600fee88888822999eeee880000000000000000000000000000000000
000770000b33ccbb00a00aa00000000006000600000000006666666006665600066566560fee88888828229eeee8800000000000000000000000000000000000
007007006b3bbb000117871100000000000000008089a700066655600066000000666660fee88888828222299e88888000000000000000000000000000000000
00000000003333300a17871a02c3a9800070000000000000006656000000000000066000feee88888828222999e8888880080000000000000000000000000000
0000000006bb000009178719000000000000000008089a70000660000000000000000000fee8e88888822229999ee88000000000000000000000000000000000
000000000000000001007001000000000000000000000800000000000000000000000000feee88882822222999eeeee800000000000000000000000000000000
000000000000000001077701000000000000000000000900000000000000000000000000fee8e888828222299eeee88880000800000000000000000000000000
000000000000000008007008000000000000000000000a70000000000000000000000000fee8888888282229eeee880000000000000000000000000000000000
0000000000000000070070070000000000000000000800000000000000000000000000000fee88888882229eee88888800000000000000000000000000000000
00000000000000000800000800000000000000000008000000000000000000000000000000fee88882822999e888800000000000000000000000000000000000
000000000000000007007007000000000000000000080000000000000000000000000000000fee8888229eeeee80008000000000000000000000000000000000
000000000000000000000000000000000000000000099a700000000000000000000000000000feee222999000000000000000000000000000000000000000000
00000000000000000a00700a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000666666660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000006dddddd10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000006d1111d10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000006d1dd6d10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000006d1dd6d10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000006d1666d10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000006dddddd10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000a070000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000099aa0000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000aa0000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000aaaa00000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000aaaaa0000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000aaaa00000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000090900000000000000000000000000000000000000000000000000
__gff__
0000010000000101010000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000002100000000002100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000002100000000002100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000002100000000002100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000002100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000002100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000210000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000210000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000210000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000002100000000210000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000002100000000210000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000002100000000210000002100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000002100000000210000002100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000002100000000210000002100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000002100000000210000002100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
0001000039050380503705036050350503305032050300402c0402802025010210101b050120500e0500905006050040500000000000000000000000000000000000000000000000000000000000000000000000
0010000000000260502605025050220501f0501d0501b05019050190501b0501d0501f0501b0501b05016050120500b050090500f0500a0500905005050050500000000000000000000000000000000000000000
00040000000002415022150201501d1501b15016150151500f1500b15009150051500315002150011500115002150000000115001150000000000000000000000000000000000000000000000000000000000000
0010000034550345503455033550315502f5502c5502a55027550255502355021550205501d5501b5501a550155501a5501b5501d5501d5501f5502255025550285502a5502d5502f55030550315503255032550
000200000735008350083500835008350063500435000350003500f3000f3000e3000d3000b300073000530003300013000030007300023000130000300023000b30000300003000030000300003000130000300
__music__
00 01424344
00 41424344
00 43434344

